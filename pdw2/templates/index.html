{% extends "base.html" %}
{% block title %}Home{% endblock %}

{% block content %}
 
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
{% raw %}
<script id="error" type="text/html">
  <div class="alert alert-danger col-xs-12">
	  <div><strong>Oh snap!</strong> apparently there was an error:</div>
	  <pre>{{msg}}</pre>
  </div>
</script>
<script id="question" type="text/html">
  <div class="alert alert-success col-xs-12">
	  {{question}}
  </div>
</script>
<script id="evaluation" type="text/html">
  <div class="alert alert-success col-xs-10 col-md-offset-2">
	  {{evaluation}}
  </div>
</script>
<script id="query" type="text/html">
  <div class="alert alert-info col-xs-12">
	  <pre>{{query}}</pre>
  </div>
</script>
<script id="answer" type="text/html">
  <div class="alert alert-warning col-xs-12">
	  {{answer}}
  </div>
</script>
<script id="response" type="text/html">
	  	<div class="col-xs-3 alert alert-{{#result}}success{{/result}}{{^result}}danger{{/result}}"><center><strong>
	  		{{#result}}<i class="fa fa-check fa-4x"></i>{{/result}}
	  		{{^result}}<i class="fa fa-times fa-4x"></i>{{/result}}
	  	</strong></center></div>
		<div class="col-xs-8 col-md-offset-1">{{response}}</div>
</script>
{% endraw %} 
<script src="https://rawgithub.com/HenrikJoreteg/ICanHaz.js/master/ICanHaz.min.js"></script>
<script>
PDC = {};
PDC.server = "http://gitsign.com:8001/api";
$(function(){
	PDC.showresult = function(data) {
		console.log(data);
//		data.error = "";
//		data.output = [{"type": "question", "question": "Into which of the following categories does the examined item fall? (1)", "id": "n0"}, {"type": "evaluation", "evaluation": "First fixation of a film (3) (4)"}, {"query": "prefix bnf-onto: <http://data.bnf.fr/ontology/bnf-onto/> ASK { ?x bnf-onto:subject \"Audiovisuel\"}", "type":"query"}, {"answer": "First fixation of a film (3) (4)", "type": "answer"}, {"type": "question", "question": "Was the film published or communicated to the public within 50 years from the fixation?", "id": "n1"}, {"query": "prefix dc: <http://purl.org/dc/terms/> prefix xsd: <http://www.w3.org/2001/XMLSchema#> ASK { {  ?a dc:date ?b.  FILTER (year(xsd:dateTime(?b)) +50 < year(now()) )  } }", "type": "query"}, {"answer": "No", "type": "answer"}, {"type": "question", "question": "Was the film first fixated more than 50 years ago?", "id": "n5"}, {"query": "prefix dc: <http://purl.org/dc/terms/> prefix xsd: <http://www.w3.org/2001/XMLSchema#> ASK { {  ?a dc:date ?b.  FILTER (year(xsd:dateTime(?b)) +50 < year(now()) )  } }", "type": "query"}, {"answer": "No", "type": "answer"}, {"type": "response", "response": "The related right of the producer of the film producer in the first fixation of the film has not expired. Please contact the right-holder before use.", "result": false}];
        $('#results').empty();

        if (data.output == "" && data.error != ""){
        	$('#results').append(ich.error({msg:data.error}))
        }else{
        	for (var s in data.output){
        		step = data.output[s];
        		ich[step.type](step).appendTo('#results');
        	}
        }
    }

	$('#submit').on('click',function(){
		$.getJSON(PDC.server+'/pd',{
				"jurisdiction": $('#jurisdiction').val(),
				work:$('#work').val(),
				detail:$('#detail').val()
			},PDC.showresult);
	});
	$.getJSON(PDC.server+'/jurisdictions', function(data){
		$(data.valid).each(function(e,i){
			$('#jurisdiction').append('<option value="'+i+'">'+i+'</option>');
		});
		$('.sample_url').on('click', function(){
			$('#work').val($(this).data('url'));
			$('#jurisdiction').val($(this).data('jurisdiction'));
		});
	});
});
</script>
<section>
    <h2>Bienvenue!</h2>
	<div class="primary col-xs-5" >
		<p>
		Les calculateurs du domaine public visent à faciliter la compréhension du statut juridique d’une oeuvre et établir, pour un pays donné, si elle déjà est dans le domaine public. La connaissance du statut juridique des oeuvres ou de leurs copies numériques est primordiale au développement de nouveaux services qui réutilisent et valorisent le domaine public.</p>
		nouveaux services qui réutilisent et valorisent le domaine public.<br/></p>
<iframe src="//player.vimeo.com/video/78740619" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
	</div>
	<div class="secondary col-xs-5 col-md-offset-2">
		<p>Essayer le calculateur:</p>
		<p class="row">
			<input type="hidden" name="jurisdiction" id="jurisdiction" class="col-xs-6" value="france/BNF">
		</p>
		<p class="row">
			<span class="col-xs-6"> <i class="fa fa-link fa-fw"></i>Coller les métadonnées bibiographiques ici:</span>
			<input type="text" name="work" id="work" class="col-xs-6">
			<!--<select name="number" id="number">
			<option>2</option>
			<option>3</option>
			<option>4</option>
			<option>5</option>
			<option>6</option>
			<option>7</option>
			<option>8</option>
			<option>9</option>
			<option>10</option>
			</select>-->
		</p>
		<p class="row">
			<span class="col-xs-6"> <i class="fa fa-question fa-fw"></i>Example de métadonnées:</span>
			<a class="sample_url" data-url="http://data.bnf.fr/15533097/2046___film/rdf.xml" data-jurisdiction="france/bnf">2046 - Wong Kar Wai - Bnf France</a>
		</p>
		<p class="row">
			<span class="col-xs-6"> <i class="fa fa-signal fa-fw"></i>Sélectionnez le niveau de details pour la réponse:</span>
			<select name="detail" id="detail" class="col-xs-6">
				<option value="low" >faible</option>
				<option value="medium">moyen</option>
				<option value="high">élevés</option>
			</select>
		</p>
		<p class="row">
			<button type="button" name="submit" value="Calculate!" id="submit" class="btn btn-info col-xs-12" >Calculer!</button>
		</p>
		<div class="row">
			Résultats:
		</div>
		<div id="results" class="well row">
		</div>
	</div>
</section>
{% endblock %}
